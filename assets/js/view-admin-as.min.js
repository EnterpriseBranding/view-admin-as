;/**
 * View Admin As
 * https://wordpress.org/plugins/view-admin-as/
 *
 * @author Jory Hogeveen <info@keraweb.nl>
 * @package view-admin-as
 * @version 1.6.1
 */

if("undefined"==typeof VAA_View_Admin_As)var VAA_View_Admin_As={ajaxurl:null,siteurl:"",_debug:!1,_vaa_nonce:"",__no_users_found:"No users found.",__success:"Success",__confirm:"Are you sure?",view_as:!1};!function(e){VAA_View_Admin_As.prefix="#wpadminbar #wp-admin-bar-vaa ",VAA_View_Admin_As.root="#wp-admin-bar-vaa","undefined"==typeof VAA_View_Admin_As._debug?VAA_View_Admin_As._debug=0:VAA_View_Admin_As._debug=parseInt(VAA_View_Admin_As._debug),"undefined"==typeof VAA_View_Admin_As.ajaxurl&&"undefined"!=typeof ajaxurl&&(VAA_View_Admin_As.ajaxurl=ajaxurl),VAA_View_Admin_As._touchmove=!1,e(document).on("touchmove",function(){VAA_View_Admin_As._touchmove=!0}),e(document).on("touchstart",function(){VAA_View_Admin_As._touchmove=!1}),VAA_View_Admin_As.init=function(){VAA_View_Admin_As.init_caps(),VAA_View_Admin_As.init_roles(),VAA_View_Admin_As.init_users(),VAA_View_Admin_As.init_settings(),VAA_View_Admin_As.init_module_role_defaults(),e(window).load(function(){e(VAA_View_Admin_As.prefix+".ab-vaa-toggle").each(function(){var i=e(this).parent().children().not(".ab-vaa-toggle");e(this).hasClass("active")||i.hide(),e(this).on("click",function(t){t.preventDefault(),e(this).hasClass("active")?(i.slideUp("fast"),e(this).removeClass("active")):(i.slideDown("fast"),e(this).addClass("active"))}),e(this).on("keyup",function(t){t.preventDefault();var s=t.which;!e(this).hasClass("active")||13!=s&&32!=s&&38!=s?13!=s&&32!=s&&40!=s||(i.slideDown("fast"),e(this).addClass("active")):(i.slideUp("fast"),e(this).removeClass("active"))})})}),e(document).on("click touchend",VAA_View_Admin_As.prefix+".vaa-reset-item > .ab-item",function(i){return i.preventDefault(),!0!==VAA_View_Admin_As._touchmove?"vaa_reload"!=e("button",this).attr("name")?(VAA_View_Admin_As.ajax({reset:!0},!0),!1):void window.location.reload():void 0})},VAA_View_Admin_As.ajax=function(i,t){var s=e("body");e("#wpadminbar .vaa-update").remove(),s.append('<div id="vaa-overlay"><span class="vaa-loader-icon" style="background: transparent url(\''+VAA_View_Admin_As.siteurl+"/wp-includes/images/spinner-2x.gif') center center no-repeat; background-size: contain;\"></span></div>"),e("body #vaa-overlay").fadeIn("fast");var n=!1;e(VAA_View_Admin_As.prefix).hasClass("fullPopupActive")&&(n=!0,e(VAA_View_Admin_As.prefix).removeClass("fullPopupActive"));var a={action:"view_admin_as",_vaa_nonce:VAA_View_Admin_As._vaa_nonce,view_admin_as:i};if(!e(VAA_View_Admin_As.prefix+"#vaa-settings-view-mode-single").is(":checked")||"undefined"==typeof i.caps&&"undefined"==typeof i.role&&"undefined"==typeof i.user)e.post(VAA_View_Admin_As.ajaxurl,a,function(i){1===VAA_View_Admin_As._debug&&console.log(i),"undefined"!=typeof i.success&&!0===i.success?!1===t?"undefined"!=typeof i.data&&"undefined"!=typeof i.data.content?("undefined"==typeof i.data.type&&(i.data.type="default"),"object"!=typeof i.data.content&&(i.data.content=String(i.data.content)),VAA_View_Admin_As.overlay(i.data.content,String(i.data.type))):(e("body #vaa-overlay").addClass("success").fadeOut("fast",function(){e(this).remove()}),VAA_View_Admin_As.notice(VAA_View_Admin_As.__success,"success")):(window.location.hash="",window.location.replace(window.location.href.replace("#","").replace("?reset-view","").replace("&reset-view","").replace("?reset-all-views","").replace("&reset-all-views",""))):(e("body #vaa-overlay").addClass("error").fadeOut("fast",function(){e(this).remove()}),!0===n&&e(VAA_View_Admin_As.prefix).addClass("fullPopupActive"),"undefined"!=typeof i.data&&("undefined"!=typeof i.data.content?("undefined"==typeof i.data.type&&(i.data.type="error"),VAA_View_Admin_As.notice(i.data.content,i.data.type)):VAA_View_Admin_As.notice(i.data,"error")))});else{s.append('<form id="vaa_single_mode_form" style="display:none;" method="post"></form>');var _=e("#vaa_single_mode_form");_.append('<input type="hidden" name="action" value="'+a.action+'">'),_.append('<input type="hidden" name="_vaa_nonce" value="'+a._vaa_nonce+'">'),_.append('<input id="data" type="hidden" name="view_admin_as">'),_.find("#data").val(JSON.stringify(a.view_admin_as)),_.submit()}},VAA_View_Admin_As.notice=function(i,t){e("#wp-admin-bar-top-secondary").append('<li class="vaa-update vaa-'+t+'"><span class="remove ab-icon dashicons dashicons-dismiss" style="top: 2px;"></span>'+i+"</li>"),e("#wpadminbar .vaa-update .remove").click(function(){e(this).parent().remove()}),setTimeout(function(){e("#wpadminbar .vaa-update").fadeOut("fast",function(){e(this).remove()})},5e3)},VAA_View_Admin_As.overlay=function(i,t){var s="body #vaa-overlay";e(s).html('<div class="vaa-overlay-container"><span class="remove dashicons dashicons-dismiss"></span><div class="vaa-response-data"></div></div>'),"textarea"==t?("undefined"!=typeof i.text&&e(s+" .vaa-response-data").append("<p>"+i.text+"</p>"),"undefined"!=typeof i.textareacontent&&(e(s+" .vaa-response-data").append('<textarea style="width: 100%;" readonly>'+i.textareacontent+"</textarea>"),e(s+" .vaa-response-data textarea").click(function(){e(this).select()}))):"errorlist"==t?("undefined"!=typeof i.text&&e(s+" .vaa-response-data").append("<p>"+i.text+"</p>"),"undefined"!=typeof i.errors&&(e(s+" .vaa-response-data").append('<ul class="errorlist"></ul>'),i.errors.forEach(function(i){e(s+" .vaa-response-data .errorlist").append("<li>"+i+"</li>")}))):e(s+" .vaa-response-data").append("<div>"+i+"</div>"),e(s+" .vaa-overlay-container .remove").click(function(){e(s).fadeOut("fast",function(){e(this).remove()})}),e(document).mouseup(function(i){e(s+" .vaa-overlay-container").each(function(){e(this).is(i.target)||0!==e(this).has(i.target).length||e(s).fadeOut("fast",function(){e(this).remove()})})})},VAA_View_Admin_As.init_settings=function(){var i=VAA_View_Admin_As.root+"-settings",t="vaa-settings";e(document).on("change",VAA_View_Admin_As.prefix+i+"-admin-menu-location select#"+t+"-admin-menu-location",function(i){i.preventDefault();var t=e(this).val();if(t&&""!==t){var s={user_setting:{admin_menu_location:t}};VAA_View_Admin_As.ajax(s,!0)}}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-view-mode input.radio."+t+"-view-mode",function(i){i.preventDefault();var t=e(this).val();if(t&&""!==t){var s={user_setting:{view_mode:t}};VAA_View_Admin_As.ajax(s,!1)}}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-force-group-users input#"+t+"-force-group-users",function(e){e.preventDefault();var i={user_setting:{force_group_users:"no"}};this.checked&&(i={user_setting:{force_group_users:"yes"}}),VAA_View_Admin_As.ajax(i,!0)}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-hide-front input#"+t+"-hide-front",function(e){e.preventDefault();var i={user_setting:{hide_front:"no"}};this.checked&&(i={user_setting:{hide_front:"yes"}}),VAA_View_Admin_As.ajax(i,!1)}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-freeze-locale input#"+t+"-freeze-locale",function(e){e.preventDefault();var i={user_setting:{freeze_locale:"no"}};this.checked&&(i={user_setting:{freeze_locale:"yes"}});var t=!1;"object"==typeof VAA_View_Admin_As.view_as&&"undefined"!=typeof VAA_View_Admin_As.view_as.user&&(t=!0),VAA_View_Admin_As.ajax(i,t)})},VAA_View_Admin_As.init_roles=function(){e(document).on("click touchend",VAA_View_Admin_As.prefix+".vaa-role-item > a.ab-item",function(i){if(!0!==VAA_View_Admin_As._touchmove&&(i.preventDefault(),!e(this).parent().hasClass("not-a-view"))){var t={role:String(e(this).attr("rel"))};return VAA_View_Admin_As.ajax(t,!0),!1}})},VAA_View_Admin_As.init_users=function(){var i=VAA_View_Admin_As.root+"-users";e(document).on("click touchend",VAA_View_Admin_As.prefix+".vaa-user-item > a.ab-item",function(i){if(!0!==VAA_View_Admin_As._touchmove&&(i.preventDefault(),!e(this).parent().hasClass("not-a-view"))){var t={user:parseInt(e(this).attr("rel"))};return VAA_View_Admin_As.ajax(t,!0),!1}}),e(document).on("keyup",VAA_View_Admin_As.prefix+i+" .ab-vaa-search.search-users input",function(){if(e(VAA_View_Admin_As.prefix+" .ab-vaa-search #vaa-searchuser-results").empty(),1<=e(this).val().length){var i=e(this).val();e(VAA_View_Admin_As.prefix+".vaa-user-item").each(function(){var t=e(".ab-item",this).text();if(-1<t.toLowerCase().indexOf(i.toLowerCase())){var s=!1;e(VAA_View_Admin_As.prefix+".ab-vaa-search #vaa-searchuser-results .vaa-user-item .ab-item").each(function(){e(this).text().indexOf(t)>-1&&(s=e(this))});var n=e(this).parents(".vaa-role-item").children(".ab-item").attr("rel");!1!==s&&s.length?s.find(".user-role").text(s.find(".user-role").text().replace(")",", "+n+")")):e(this).clone().appendTo(VAA_View_Admin_As.prefix+".ab-vaa-search #vaa-searchuser-results").children(".ab-item").append(' &nbsp; <span class="user-role">('+n+")</span>")}}),""===e.trim(e(VAA_View_Admin_As.prefix+".ab-vaa-search #vaa-searchuser-results").html())&&e(VAA_View_Admin_As.prefix+".ab-vaa-search #vaa-searchuser-results").append('<div class="ab-item ab-empty-item vaa-not-found">'+VAA_View_Admin_As.__no_users_found+"</div>")}})},VAA_View_Admin_As.init_caps=function(){var i=VAA_View_Admin_As.root+"-caps";VAA_View_Admin_As.caps_filter_settings={selectedRole:"default",selectedRoleCaps:{},selectedRoleReverse:!1,filterString:""},VAA_View_Admin_As.filter_capabilities=function(){e(VAA_View_Admin_As.prefix+i+"-quickselect-options .vaa-cap-item").each(function(){var i;!0===VAA_View_Admin_As.caps_filter_settings.selectedRoleReverse?(e(this).hide(),1<=VAA_View_Admin_As.caps_filter_settings.filterString.length?(i=e(this).text(),-1<i.toLowerCase().indexOf(VAA_View_Admin_As.caps_filter_settings.filterString.toLowerCase())&&e(this).show()):e(this).show(),"default"!=VAA_View_Admin_As.caps_filter_settings.selectedRole&&e("input",this).attr("value")in VAA_View_Admin_As.caps_filter_settings.selectedRoleCaps&&e(this).hide()):(e(this).hide(),("default"==VAA_View_Admin_As.caps_filter_settings.selectedRole||e("input",this).attr("value")in VAA_View_Admin_As.caps_filter_settings.selectedRoleCaps)&&(1<=VAA_View_Admin_As.caps_filter_settings.filterString.length?(i=e(this).text(),-1<i.toLowerCase().indexOf(VAA_View_Admin_As.caps_filter_settings.filterString.toLowerCase())&&e(this).show()):e(this).show()))})},e(document).on("mouseenter",VAA_View_Admin_As.prefix+i+"-quickselect",function(){e(VAA_View_Admin_As.prefix+i+"-quickselect-options").css({"max-height":e(window).height()-350+"px"})}),e(document).on("click",VAA_View_Admin_As.prefix+i+" #open-caps-popup",function(){e(VAA_View_Admin_As.prefix).addClass("fullPopupActive"),e(VAA_View_Admin_As.prefix+i+"-quickselect > .ab-sub-wrapper").addClass("fullPopup")}),e(document).on("click",VAA_View_Admin_As.prefix+i+" #close-caps-popup",function(){e(VAA_View_Admin_As.prefix).removeClass("fullPopupActive"),e(VAA_View_Admin_As.prefix+i+"-quickselect > .ab-sub-wrapper").removeClass("fullPopup")}),e(document).on("change",VAA_View_Admin_As.prefix+i+" .ab-vaa-select.select-role-caps select",function(){if(VAA_View_Admin_As.caps_filter_settings.selectedRole=e(this).val(),"default"==VAA_View_Admin_As.caps_filter_settings.selectedRole)VAA_View_Admin_As.caps_filter_settings.selectedRoleCaps={},VAA_View_Admin_As.caps_filter_settings.selectedRoleReverse=!1;else{var t=e(VAA_View_Admin_As.prefix+i+'-selectrolecaps #vaa-caps-selectrolecaps option[value="'+VAA_View_Admin_As.caps_filter_settings.selectedRole+'"]');VAA_View_Admin_As.caps_filter_settings.selectedRoleCaps=JSON.parse(t.attr("data-caps")),"1"==t.attr("data-reverse")?VAA_View_Admin_As.caps_filter_settings.selectedRoleReverse=!0:VAA_View_Admin_As.caps_filter_settings.selectedRoleReverse=!1}VAA_View_Admin_As.filter_capabilities()}),e(document).on("keyup",VAA_View_Admin_As.prefix+i+" .ab-vaa-filter input",function(){1<=e(this).val().length?VAA_View_Admin_As.caps_filter_settings.filterString=e(this).val():VAA_View_Admin_As.caps_filter_settings.filterString="",VAA_View_Admin_As.filter_capabilities()}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+" button#select-all-caps",function(t){return!0!==VAA_View_Admin_As._touchmove?(t.preventDefault(),e(VAA_View_Admin_As.prefix+i+"-quickselect-options .vaa-cap-item").each(function(){e(this).is(":visible")&&e("input",this).prop("checked",!0)}),!1):void 0}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+" button#deselect-all-caps",function(t){return!0!==VAA_View_Admin_As._touchmove?(t.preventDefault(),e(VAA_View_Admin_As.prefix+i+"-quickselect-options .vaa-cap-item").each(function(){e(this).is(":visible")&&e("input",this).prop("checked",!1)}),!1):void 0}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+" button#apply-caps-view",function(t){if(!0!==VAA_View_Admin_As._touchmove){t.preventDefault();var s="";return e(VAA_View_Admin_As.prefix+i+"-quickselect-options .vaa-cap-item input").each(function(){s+=e(this).is(":checked")?e(this).attr("value")+":1,":e(this).attr("value")+":0,"}),VAA_View_Admin_As.ajax({caps:s},!0),!1}})},VAA_View_Admin_As.init_module_role_defaults=function(){var i=VAA_View_Admin_As.root+"-settings",t="vaa-settings";e(document).on("change",VAA_View_Admin_As.prefix+i+"-role-defaults-enable input#"+t+"-role-defaults-enable",function(e){e.preventDefault();var i={role_defaults:{enable:0}};this.checked&&(i={role_defaults:{enable:!0}}),VAA_View_Admin_As.ajax(i,!0)}),i=VAA_View_Admin_As.root+"-role-defaults",t="vaa-role-defaults",e(document).on("change",VAA_View_Admin_As.prefix+i+"-setting-register-enable input#"+t+"-setting-register-enable",function(e){e.preventDefault();var i={role_defaults:{apply_defaults_on_register:0}};this.checked&&(i={role_defaults:{apply_defaults_on_register:!0}}),VAA_View_Admin_As.ajax(i,!1)}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-setting-disable-user-screen-options input#"+t+"-setting-disable-user-screen-options",function(e){e.preventDefault();var i={role_defaults:{disable_user_screen_options:0}};this.checked&&(i={role_defaults:{disable_user_screen_options:!0}}),VAA_View_Admin_As.ajax(i,!1)}),e(document).on("change",VAA_View_Admin_As.prefix+i+"-setting-lock-meta-boxes input#"+t+"-setting-lock-meta-boxes",function(e){e.preventDefault();var i={role_defaults:{lock_meta_boxes:0}};this.checked&&(i={role_defaults:{lock_meta_boxes:!0}}),VAA_View_Admin_As.ajax(i,!1)}),e(document).on("keyup",VAA_View_Admin_As.prefix+i+"-bulk-users-filter input#"+t+"-bulk-users-filter",function(t){if(t.preventDefault(),e(this).val().length>=1){var s=e(this).val();e(VAA_View_Admin_As.prefix+i+"-bulk-users-select .ab-item.vaa-item").each(function(){var i=e(".user-name",this).text();i.toLowerCase().indexOf(s.toLowerCase())>-1?e(this).show():e(this).hide()})}else e(VAA_View_Admin_As.prefix+i+"-bulk-users-select .ab-item.vaa-item").each(function(){e(this).show()})}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+"-bulk-users-apply button#"+t+"-bulk-users-apply",function(t){if(!0!==VAA_View_Admin_As._touchmove){t.preventDefault();var s=[];if(e(VAA_View_Admin_As.prefix+i+"-bulk-users-select .ab-item.vaa-item input").each(function(){e(this).is(":checked")&&s.push(e(this).val())}),s){var n={role_defaults:{apply_defaults_to_users:s}};VAA_View_Admin_As.ajax(n,!1)}return!1}}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+"-bulk-roles-apply button#"+t+"-bulk-roles-apply",function(s){if(!0!==VAA_View_Admin_As._touchmove){s.preventDefault();var n=e(VAA_View_Admin_As.prefix+i+"-bulk-roles-select select#"+t+"-bulk-roles-select").val();if(n&&""!==n){var a={role_defaults:{apply_defaults_to_users_by_role:n}};VAA_View_Admin_As.ajax(a,!1)}return!1}}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+"-clear-roles-apply button#"+t+"-clear-roles-apply",function(s){if(!0!==VAA_View_Admin_As._touchmove){s.preventDefault();var n=e(VAA_View_Admin_As.prefix+i+"-clear-roles-select select#"+t+"-clear-roles-select").val();if(n&&""!==n){var a={role_defaults:{clear_role_defaults:n}};confirm(VAA_View_Admin_As.__confirm)&&VAA_View_Admin_As.ajax(a,!1)}return!1}}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+"-export-roles-export button#"+t+"-export-roles-export",function(s){if(!0!==VAA_View_Admin_As._touchmove){s.preventDefault();var n=e(VAA_View_Admin_As.prefix+i+"-export-roles-select select#"+t+"-export-roles-select").val();if(n&&""!==n){var a={role_defaults:{export_role_defaults:n}};VAA_View_Admin_As.ajax(a,!1)}return!1}}),e(document).on("click touchend",VAA_View_Admin_As.prefix+i+"-import-roles-import button#"+t+"-import-roles-import",function(s){if(!0!==VAA_View_Admin_As._touchmove){s.preventDefault();var n=e(VAA_View_Admin_As.prefix+i+"-import-roles-input textarea#"+t+"-import-roles-input").val();if(n&&""!==n){var a={role_defaults:{import_role_defaults:n}};VAA_View_Admin_As.ajax(a,!1)}return!1}})},"undefined"!=typeof VAA_View_Admin_As._vaa_nonce&&VAA_View_Admin_As.init()}(jQuery);